# ç¾å®¹å®¤ãƒ˜ã‚¢ã‚¹ã‚¿ã‚¤ãƒ«å†ç¾ã‚¢ãƒ—ãƒª å®Œå…¨è¦ä»¶å®šç¾©æ›¸ (MVPç‰ˆ)

## ğŸ“‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### 1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå

**Hair Style AI Generator** - ç¾å®¹å®¤ã®ãŸã‚ã®AIãƒ˜ã‚¢ã‚¹ã‚¿ã‚¤ãƒ«å†ç¾ãƒ„ãƒ¼ãƒ«

### 1.2 ç›®çš„

ç¾å®¹å®¤ã®Webã‚µã‚¤ãƒˆã«æ²è¼‰ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ç”»åƒã‚’ã€æœ€æ–°ã®FLUX.1 Kontext AIã‚’æ´»ç”¨ã—ã¦ãƒ˜ã‚¢ã‚«ãƒƒãƒˆãƒ»ãƒ˜ã‚¢ã‚«ãƒ©ãƒ¼ã«å¤‰æ›´ã—ã€é­…åŠ›çš„ãªãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’åŠ¹ç‡çš„ã«ä½œæˆã™ã‚‹ã€‚

### 1.3 é–‹ç™ºæ–¹é‡

- **MVPé‡è¦–**ï¼šæ ¸å¿ƒæ©Ÿèƒ½ã«é›†ä¸­ã—ãŸè¿…é€Ÿãªå®Ÿè£…
- **å•†ç”¨åˆ©ç”¨å¯¾å¿œ**ï¼š1æ—¥200æšã®ç”Ÿæˆé‡ã«å¯¾å¿œ
- **ãƒãƒ«ãƒãƒ¦ãƒ¼ã‚¶ãƒ¼å¯¾å¿œ**ï¼šè¤‡æ•°ç¾å®¹å¸«ã®åŒæ™‚åˆ©ç”¨
- **æ‹¡å¼µå¯èƒ½è¨­è¨ˆ**ï¼šå°†æ¥ã®æ©Ÿèƒ½è¿½åŠ ã‚’è¦‹æ®ãˆãŸæ§‹é€ 

### 1.4 æŠ€è¡“çš„å„ªä½æ€§

- FLUX.1 Kontextã¯2025å¹´5æœˆ29æ—¥ãƒªãƒªãƒ¼ã‚¹ã®æœ€æ–°æŠ€è¡“ã§ã€äººç‰©ã®é¡”ãƒ»è¡¨æƒ…ã®ä¸€è²«æ€§ä¿æŒã«ç‰¹åŒ–ã—ã€æœ€å¤§8å€ã®é«˜é€Ÿå‡¦ç†ã‚’å®Ÿç¾

## ğŸ¯ æ©Ÿèƒ½è¦ä»¶

### 2.1 ã‚³ã‚¢æ©Ÿèƒ½ï¼ˆå¿…é ˆå®Ÿè£…ï¼‰

### 2.1.1 ç”»åƒå…¥åŠ›

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€ãƒ˜ã‚¢ã‚¹ã‚¿ã‚¤ãƒ«å¤‰æ›´ã®å…ƒã¨ãªã‚‹ç”»åƒã‚’ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®æ–¹æ³•ã§æŒ‡å®šã§ãã‚‹ã€‚

1.  **ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**
    *   ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã‹ã‚‰ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆJPG, PNG, WebPå½¢å¼ï¼‰ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã€‚
    *   ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ãŠã‚ˆã³ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®ä¸¡æ–¹ã«å¯¾å¿œã™ã‚‹ã€‚
    *   ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸç”»åƒã¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã•ã‚Œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å¤‰æ›´å¯¾è±¡ã®ç”»åƒã‚’ç¢ºèªã§ãã‚‹ã€‚
    *   ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¯æœ€å¤§10MBã¾ã§ã¨ã™ã‚‹ã€‚

2.  **URLæŒ‡å®šã«ã‚ˆã‚‹ç”»åƒå–å¾—**
    *   ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯HotPepperBeautyã®ã‚¹ã‚¿ã‚¤ãƒ«è©³ç´°ãƒšãƒ¼ã‚¸ã®URLã‚’ç›´æ¥å…¥åŠ›ã§ãã‚‹ã€‚
    *   å…¥åŠ›ã•ã‚ŒãŸURLã‹ã‚‰ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè‡ªå‹•çš„ã«ãƒ¡ã‚¤ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ç”»åƒã‚’æŠ½å‡ºï¼ˆã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ï¼‰ã™ã‚‹ã€‚
    *   æŠ½å‡ºã•ã‚ŒãŸç”»åƒã¯é«˜ç”»è³ªåŒ–ï¼ˆURLã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‰Šé™¤ï¼‰ã•ã‚ŒãŸå¾Œã€ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã•ã‚Œã‚‹ã€‚
    *   URLã®ä¸æ­£ã€ç”»åƒã®å–å¾—å¤±æ•—ãªã©ã€ã‚¨ãƒ©ãƒ¼æ™‚ã«ã¯é©åˆ‡ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤ºã™ã‚‹ã€‚

### 2.1.2 ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–ã‚¨ãƒ³ã‚¸ãƒ³

```python
# å®Ÿè£…ä»•æ§˜ä¾‹
def optimize_hair_style_prompt(japanese_input, image_analysis):
    """
    æ—¥æœ¬èªæŒ‡ç¤ºã‚’FLUX.1 Kontextæœ€é©ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«å¤‰æ›

    å…¥åŠ›ä¾‹: "ã‚·ãƒ§ãƒ¼ãƒˆãƒœãƒ–ã§èŒ¶è‰²ã®é«ªã«å¤‰æ›´ã—ã¦ãã ã•ã„"
    å‡ºåŠ›ä¾‹: "Transform the woman with long black hair to have a short bob cut,
            change hair color to warm brown, maintain identical facial features,
            expression, and composition, keep the same lighting and background"
    """

    system_prompt = """
    ã‚ãªãŸã¯ç¾å®¹å®¤ã®ãƒ˜ã‚¢ã‚¹ã‚¿ã‚¤ãƒ«å¤‰æ›´ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–ã®å°‚é–€å®¶ã§ã™ã€‚
    æ—¥æœ¬èªã®æŒ‡ç¤ºã‚’FLUX.1 Kontextã§æœ€é©ãªè‹±èªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«å¤‰æ›ã—ã¦ãã ã•ã„ã€‚

    å¤‰æ›ãƒ«ãƒ¼ãƒ«:
    1. äººç‰©ã®é¡”ãƒ»è¡¨æƒ…ã®ä¸€è²«æ€§ä¿æŒã‚’å¿…é ˆã§å«ã‚ã‚‹
    2. å…·ä½“çš„ãªãƒ˜ã‚¢ã‚¹ã‚¿ã‚¤ãƒ«åç§°ã‚’ä½¿ç”¨
    3. èƒŒæ™¯ãƒ»æ§‹å›³ãƒ»ç…§æ˜ã®ä¿æŒã‚’æŒ‡ç¤º
    4. 512ãƒˆãƒ¼ã‚¯ãƒ³ä»¥å†…ã§ç°¡æ½”ã«
    5. "maintain identical" "keep the same"ã‚’æ´»ç”¨
    """

    full_prompt = f"""
    {system_prompt}

    æ—¥æœ¬èªæŒ‡ç¤º: {japanese_input}
    ç”»åƒã®ç‰¹å¾´: {image_analysis}

    æœ€é©åŒ–ã•ã‚ŒãŸè‹±èªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:
    """

    # Gemini 2.5 Flash ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–
    from google import genai
    from google.genai.types import GenerateContentConfig, ThinkingConfig
    
    client = genai.Client(api_key=os.getenv('GEMINI_API_KEY'))
    
    response = client.models.generate_content(
        model="gemini-2.5-flash",
        contents=full_prompt,
        config=GenerateContentConfig(
            thinking_config=ThinkingConfig(
                thinking_budget=0  # é€Ÿåº¦é‡è¦–
            ),
            temperature=0.3,
            top_p=0.8,
            max_output_tokens=512
        )
    )
    
    return response.text
```

### 2.1.3 AIç”»åƒç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ 

```python
# FLUX.1 Kontext APIçµ±åˆä»•æ§˜ï¼ˆç¢ºå®Ÿãªæƒ…å ±ï¼‰
class FluxKontextService:
    def __init__(self):
        self.api_key = os.getenv('BFL_API_KEY')
        self.base_url = "https://api.us1.bfl.ai/v1"

    def generate_hair_style(self, image_base64, optimized_prompt):
        """
        ãƒ˜ã‚¢ã‚¹ã‚¿ã‚¤ãƒ«ç”»åƒç”Ÿæˆ

        Parameters:
        - image_base64: å…ƒç”»åƒï¼ˆbase64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ï¼‰
        - optimized_prompt: æœ€é©åŒ–ã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆ512ãƒˆãƒ¼ã‚¯ãƒ³ä»¥å†…ï¼‰

        Returns:
        - task_id: éåŒæœŸå‡¦ç†ç”¨ID
        """

        endpoint = f"{self.base_url}/flux-kontext-pro"

        payload = {
            "prompt": optimized_prompt,
            "input_image": image_base64,
            "seed": None,  # å†ç¾æ€§ã®ãŸã‚å¿…è¦ã«å¿œã˜ã¦è¨­å®š
            "safety_tolerance": 2,  # 0=å³æ ¼ã€6=å¯›å®¹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ2ï¼‰
            "output_format": "jpeg",  # "jpeg" ã¾ãŸã¯ "png"
            "webhook_url": None,  # éåŒæœŸé€šçŸ¥ç”¨ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
            "webhook_secret": None  # Webhookèªè¨¼ç”¨ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
        }

        headers = {
            "accept": "application/json",
            "x-key": self.api_key,
            "Content-Type": "application/json"
        }

        response = requests.post(endpoint, headers=headers, json=payload)
        
        if response.status_code == 200:
            return response.json()["id"]
        else:
            raise Exception(f"API Error: {response.status_code} - {response.text}")

    def get_result(self, task_id):
        """
        çµæœå–å¾—ï¼ˆãƒãƒ¼ãƒªãƒ³ã‚°ç”¨ï¼‰
        
        Returns:
        - status: "Processing", "Queued", "Ready", "Error", "Content Moderated"
        - result: æˆåŠŸæ™‚ã¯ç”»åƒURLã‚’å«ã‚€
        """
        url = f"{self.base_url}/get_result"
        headers = {"accept": "application/json", "x-key": self.api_key}
        params = {"id": task_id}

        response = requests.get(url, headers=headers, params=params)
        
        if response.status_code == 200:
            result = response.json()
            # ç½²åä»˜ãURLã¯10åˆ†é–“ã®ã¿æœ‰åŠ¹
            return result
        else:
            raise Exception(f"API Error: {response.status_code} - {response.text}")

    def poll_until_ready(self, task_id, max_wait_time=300):
        """
        çµæœãŒæº–å‚™ã§ãã‚‹ã¾ã§ãƒãƒ¼ãƒªãƒ³ã‚°
        
        Parameters:
        - task_id: ã‚¿ã‚¹ã‚¯ID
        - max_wait_time: æœ€å¤§å¾…æ©Ÿæ™‚é–“ï¼ˆç§’ï¼‰
        
        Returns:
        - ç”»åƒURLï¼ˆæˆåŠŸæ™‚ï¼‰
        """
        import time
        start_time = time.time()
        
        while time.time() - start_time < max_wait_time:
            result = self.get_result(task_id)
            status = result.get("status")
            
            if status == "Ready":
                # ç½²åä»˜ãURLã¯10åˆ†ä»¥å†…ã«å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
                return result["result"]["sample"]
            elif status in ["Error", "Content Moderated", "Request Moderated"]:
                raise Exception(f"Generation failed: {status}")
            
            # 1.5ç§’å¾…æ©Ÿã—ã¦ã‹ã‚‰å†è©¦è¡Œ
            time.sleep(1.5)
        
        raise Exception("Timeout: Image generation took too long")
```

### 2.2 ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒãƒ«ãƒãƒ¦ãƒ¼ã‚¶ãƒ¼å¯¾å¿œï¼‰

```python
# ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ä»•æ§˜
class UserSessionManager:
    def __init__(self):
        self.redis_client = redis.Redis.from_url(os.getenv('REDIS_URL'))

    def create_session(self, user_name):
        """ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ"""
        session_id = str(uuid.uuid4())
        session_data = {
            "user_name": user_name,
            "created_at": datetime.utcnow().isoformat(),
            "uploaded_images": [],
            "generated_images": [],
            "active_tasks": []
        }

        # 24æ™‚é–“æœ‰åŠ¹ãªã‚»ãƒƒã‚·ãƒ§ãƒ³
        self.redis_client.setex(
            f"session:{session_id}",
            86400,
            json.dumps(session_data)
        )

        return session_id
```

## ğŸ”§ æŠ€è¡“ä»•æ§˜

### 3.1 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

```yaml
ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰:
  - Python: 3.12.x
  - Flask: 3.0+
  - Flask-SocketIO: 5.3.6 (ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡)
  - Celery: 5.3.6 (éåŒæœŸã‚¿ã‚¹ã‚¯å‡¦ç†)
  - Redis: 5.0.1 (ã‚¿ã‚¹ã‚¯ã‚­ãƒ¥ãƒ¼ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†)
  - Pillow: 10.0.1 (ç”»åƒå‡¦ç†)

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰:
  - HTML5 + CSS3 + JavaScript (ES6+)
  - Tailwind CSS 4.1+ (æœ€æ–°ç‰ˆãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–UI)
  - Socket.IO Client (é€²æ—è¡¨ç¤º)
  - Axios (HTTPé€šä¿¡)

APIçµ±åˆ:
  - google-genai: 1.0+ (Gemini 2.5 Flash)
  - requests: 2.31.0 (FLUX.1 Kontext API)
```

### 3.2 APIçµ±åˆä»•æ§˜ï¼ˆæœ€æ–°æƒ…å ±åæ˜ ï¼‰

### 3.2.1 Gemini 2.5 Flashçµ±åˆ

Gemini 2.5 Flash ã¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–ã«æœ€é©ãªæœ€æ–°ãƒ¢ãƒ‡ãƒ«

```python
# Gemini 2.5 Flash è¨­å®š
from google import genai
from google.genai.types import GenerateContentConfig, ThinkingConfig

client = genai.Client(api_key=os.getenv('GEMINI_API_KEY'))

def optimize_prompt_with_gemini(prompt):
    """
    Gemini 2.5 Flash ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–
    é€Ÿåº¦é‡è¦–ã®ãŸã‚ thinking_budget=0 ã«è¨­å®š
    """
    response = client.models.generate_content(
        model="gemini-2.5-flash",
        contents=prompt,
        config=GenerateContentConfig(
            thinking_config=ThinkingConfig(
                thinking_budget=0  # é€Ÿåº¦é‡è¦–ã®ãŸã‚æ€è€ƒæ©Ÿèƒ½ç„¡åŠ¹åŒ–
            ),
            temperature=0.3,
            top_p=0.8,
            max_output_tokens=512
        )
    )
    return response.text
```

### 3.2.2 FLUX.1 Kontextçµ±åˆ

BFL APIã®**flux-kontext-pro**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®æ­£ç¢ºãªä»•æ§˜

```python
# æ­£ç¢ºãªFLUX.1 Kontext Pro APIä»•æ§˜
endpoint = "https://api.us1.bfl.ai/v1/flux-kontext-pro"

# å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
required_params = {
    "prompt": "ç·¨é›†æŒ‡ç¤ºï¼ˆ512ãƒˆãƒ¼ã‚¯ãƒ³ä»¥å†…ï¼‰",
    "input_image": "base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ç”»åƒ"
}

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
optional_params = {
    "seed": None,  # å†ç¾æ€§ç”¨ï¼ˆæ•´æ•°ï¼‰
    "safety_tolerance": 2,  # 0-6ï¼ˆ0=å³æ ¼ã€6=å¯›å®¹ï¼‰
    "output_format": "jpeg",  # "jpeg" or "png"
    "webhook_url": None,  # éåŒæœŸé€šçŸ¥URL
    "webhook_secret": None  # Webhookèªè¨¼
}

# ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä»•æ§˜
response_structure = {
    "id": "task_id",  # ãƒãƒ¼ãƒªãƒ³ã‚°ç”¨ID
    "status": "Queued"  # åˆæœŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
}

# çµæœå–å¾—API
get_result_endpoint = "https://api.us1.bfl.ai/v1/get_result"
get_result_params = {"id": "task_id"}

# å¯èƒ½ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
statuses = [
    "Processing",  # å‡¦ç†ä¸­
    "Queued",     # ã‚­ãƒ¥ãƒ¼å¾…ã¡
    "Ready",      # å®Œäº†
    "Error",      # ã‚¨ãƒ©ãƒ¼
    "Content Moderated",  # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ¶é™
    "Request Moderated"   # ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ¶é™
]

# é‡è¦ãªåˆ¶é™äº‹é …
limitations = {
    "prompt_max_tokens": 512,  # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€å¤§ãƒˆãƒ¼ã‚¯ãƒ³æ•°
    "signed_url_validity": "10åˆ†",  # ç½²åä»˜ãURLæœ‰åŠ¹æœŸé™
    "polling_interval": 1.5,  # æ¨å¥¨ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”ï¼ˆç§’ï¼‰
    "max_wait_time": 300  # æ¨å¥¨æœ€å¤§å¾…æ©Ÿæ™‚é–“ï¼ˆç§’ï¼‰
}
```

### 3.3 ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```mermaid
graph TB
    A[Frontend<br/>HTML/CSS/JS<br/>Tailwind CSS 4.1] --> B[Flask App<br/>Routes & Controllers]

    B --> C[Services Layer]
    C --> D[Gemini Service<br/>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–]
    C --> E[Flux Service<br/>ç”»åƒç”Ÿæˆ]
    C --> F[File Service<br/>ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†]

    B --> G[Celery Worker<br/>éåŒæœŸã‚¿ã‚¹ã‚¯å‡¦ç†]
    G --> H[Redis<br/>Queue & Session]

    D --> I[Gemini 2.5 Flash API]
    E --> J[FLUX.1 Kontext API<br/>Proåˆ©ç”¨]

    B --> K[File Storage<br/>uploads/ & generated/]

    L[Multiple Users] --> A
```

### 3.4 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
hpb-style-ai-generator/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py
â”‚   â”œâ”€â”€ routes/              # URLãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
â”‚   â”‚   â”œâ”€â”€ api.py
â”‚   â”‚   â”œâ”€â”€ generate.py
â”‚   â”‚   â”œâ”€â”€ main.py
â”‚   â”‚   â””â”€â”€ upload.py
â”‚   â”œâ”€â”€ services/            # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ file_service.py
â”‚   â”‚   â”œâ”€â”€ flux_service.py
â”‚   â”‚   â”œâ”€â”€ gemini_service.py
â”‚   â”‚   â”œâ”€â”€ scraping_service.py
â”‚   â”‚   â”œâ”€â”€ session_service.py
â”‚   â”‚   â””â”€â”€ task_service.py
â”‚   â”œâ”€â”€ static/              # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”‚   â”œâ”€â”€ ğŸ“ js/                # JavaScriptãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”‚   â”‚   â”œâ”€â”€ generate.js       # (ç”»åƒç”Ÿæˆãƒšãƒ¼ã‚¸ã®ãƒ­ã‚¸ãƒƒã‚¯)
â”‚   â”‚   â”‚   â”œâ”€â”€ session-recovery.js # (ã‚»ãƒƒã‚·ãƒ§ãƒ³å¾©å¸°å‡¦ç†)
â”‚   â”‚   â”‚   â””â”€â”€ upload.js         # (ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†)
â”‚   â”‚   â”œâ”€â”€ ğŸ“ uploads/           # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒ
â”‚   â”‚   â””â”€â”€ ğŸ“ generated/         # AIãŒç”Ÿæˆã—ãŸç”»åƒ
â”‚   â”œâ”€â”€ templates/           # HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ base.html
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ gallery.html
â”‚   â”‚   â””â”€â”€ about.html
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ decorators.py
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ conftest.py
â”‚   â”œâ”€â”€ test_load/
â”‚   â”œâ”€â”€ test_routes/
â”‚   â””â”€â”€ test_services/
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â””â”€â”€ nginx.conf.example
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ requirements.md
â”œâ”€â”€ logs/                  # ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ .env.example
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ run.py
â””â”€â”€ README.md
```

### 3.5 Celery + Flask-SocketIO çµ±åˆä»•æ§˜

```python
# Flask-SocketIOã¨Celeryã®æ­£ã—ã„çµ±åˆ
import eventlet
eventlet.monkey_patch(all=False, socket=True)

from flask import Flask
from flask_socketio import SocketIO
from celery import Celery

def create_celery_app(app=None):
    app = app or create_app()
    
    class FlaskTask(Task):
        def __call__(self, *args, **kwargs):
            with app.app_context():
                return self.run(*args, **kwargs)
    
    celery = Celery(app.import_name, task_cls=FlaskTask)
    celery.conf.update(app.config.get("CELERY_CONFIG", {}))
    celery.set_default()
    app.extensions["celery"] = celery
    return celery

# SocketIOå¤–éƒ¨ãƒ—ãƒ­ã‚»ã‚¹ç”¨è¨­å®š
def create_external_socketio():
    """Celeryãƒ¯ãƒ¼ã‚«ãƒ¼ã‹ã‚‰ã®é€šä¿¡ç”¨"""
    return SocketIO(message_queue=os.getenv('REDIS_URL'))
```

## ğŸ“… é–‹ç™ºã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

### Phase 1: åŸºç›¤æ§‹ç¯‰

```bash
# å®Ÿè£…é …ç›®
â–¡ Flask ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
â–¡ Tailwind CSS 4.1 + åŸºæœ¬UIãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â–¡ ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½å®Ÿè£…
â–¡ Redis + Celery ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
â–¡ ç’°å¢ƒå¤‰æ•°è¨­å®šï¼ˆ.envï¼‰
â–¡ DockeråŒ–æº–å‚™

# æŠ€è¡“æ¤œè¨¼
â–¡ Gemini 2.5 Flash APIæ¥ç¶šãƒ†ã‚¹ãƒˆï¼ˆthinking_budget=0ï¼‰
â–¡ FLUX.1 Kontext APIæ¥ç¶šãƒ†ã‚¹ãƒˆ
â–¡ ç”»åƒå‡¦ç†ãƒ•ãƒ­ãƒ¼ç¢ºèª
```

### Phase 2: AIçµ±åˆ

```bash
# APIçµ±åˆ
â–¡ Gemini Serviceå®Ÿè£…
â–¡ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…
â–¡ Flux Serviceå®Ÿè£…
â–¡ éåŒæœŸã‚¿ã‚¹ã‚¯å‡¦ç†å®Ÿè£…
â–¡ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–

# æ©Ÿèƒ½å®Ÿè£…
â–¡ ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–ãƒ•ãƒ­ãƒ¼
â–¡ æœ€é©åŒ– â†’ ç”»åƒç”Ÿæˆãƒ•ãƒ­ãƒ¼
â–¡ çµæœå–å¾— â†’ è¡¨ç¤ºãƒ•ãƒ­ãƒ¼
```

### Phase 3: UI/UXå®Œæˆ

```bash
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â–¡ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€²æ—è¡¨ç¤ºï¼ˆSocket.IOï¼‰
â–¡ ç”»åƒã‚®ãƒ£ãƒ©ãƒªãƒ¼æ©Ÿèƒ½
â–¡ Before/Afteræ¯”è¼ƒè¡¨ç¤º
â–¡ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
â–¡ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†UI

# ãƒãƒ«ãƒãƒ¦ãƒ¼ã‚¶ãƒ¼å¯¾å¿œ
â–¡ ãƒ¦ãƒ¼ã‚¶ãƒ¼è­˜åˆ¥ã‚·ã‚¹ãƒ†ãƒ 
â–¡ åŒæ™‚å‡¦ç†åˆ¶å¾¡
â–¡ ã‚»ãƒƒã‚·ãƒ§ãƒ³æ°¸ç¶šåŒ–
```

### Phase 4: ãƒ†ã‚¹ãƒˆãƒ»æœ€é©åŒ–

```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè£…
â–¡ å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆpytestï¼‰
â–¡ çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆFlask-Testingï¼‰
â–¡ APIåˆ¶é™ãƒ†ã‚¹ãƒˆ
â–¡ åŒæ™‚æ¥ç¶šãƒ†ã‚¹ãƒˆï¼ˆLocustï¼‰

# æœ¬ç•ªæº–å‚™
â–¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
â–¡ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–
â–¡ ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒæ§‹ç¯‰
â–¡ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ
```

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»èªè¨¼è¦ä»¶

### 5.1 åŸºæœ¬ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

```python
# CSRFä¿è­·
from flask_wtf.csrf import CSRFProtect
csrf = CSRFProtect(app)

# ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¤œè¨¼
ALLOWED_EXTENSIONS = {'png', 'jpg', 'jpeg', 'webp'}
MAX_CONTENT_LENGTH = 10 * 1024 * 1024  # 10MB

def allowed_file(filename):
    return '.' in filename and \
           filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS

# APIã‚­ãƒ¼ç®¡ç†
def get_api_keys():
    return {
        'gemini': os.getenv('GEMINI_API_KEY'),
        'bfl': os.getenv('BFL_API_KEY')
    }
```

### 5.2 ãƒ¬ãƒ¼ãƒˆåˆ¶é™

```python
from flask_limiter import Limiter
from flask_limiter.util import get_remote_address

limiter = Limiter(
    app,
    key_func=get_remote_address,
    default_limits=["200 per day", "50 per hour"]
)

@app.route('/api/generate')
@limiter.limit("10 per minute")
def generate_image():
    pass
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### 6.1 ãƒ†ã‚¹ãƒˆæ§‹é€ 

```python
# pytestè¨­å®šä¾‹
# tests/conftest.py
import pytest
from app import create_app
from app.config import TestingConfig

@pytest.fixture
def app():
    app = create_app(TestingConfig)
    return app

@pytest.fixture
def client(app):
    return app.test_client()

# APIãƒ†ã‚¹ãƒˆä¾‹
# tests/test_services/test_gemini_service.py
def test_optimize_prompt():
    service = GeminiService()
    result = service.optimize_prompt(
        "ã‚·ãƒ§ãƒ¼ãƒˆãƒœãƒ–ã«å¤‰æ›´",
        "woman with long black hair"
    )
    assert "short bob" in result.lower()
    assert "maintain" in result.lower()
```

### 6.2 è² è·ãƒ†ã‚¹ãƒˆ

```python
# locustfile.py
from locust import HttpUser, task, between

class WebsiteUser(HttpUser):
    wait_time = between(1, 5)

    @task
    def upload_image(self):
        with open("test_image.jpg", "rb") as f:
            self.client.post("/upload", files={"image": f})

    @task(3)
    def view_gallery(self):
        self.client.get("/gallery")
```

## ğŸ“¦ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### 7.1 Dockeræ§‹æˆ

```dockerfile
# Dockerfile
FROM python:3.12-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 5000

CMD ["gunicorn", "--worker-class", "eventlet", "-w", "1", "--bind", "0.0.0.0:5000", "run:app"]
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  web:
    build: .
    ports:
      - "5000:5000"
    environment:
      - REDIS_URL=redis://redis:6379/0
    depends_on:
      - redis
    volumes:
      - ./app/static/uploads:/app/app/static/uploads
      - ./app/static/generated:/app/app/static/generated

  worker:
    build: .
    command: celery -A run.celery_app worker --loglevel=info
    environment:
      - REDIS_URL=redis://redis:6379/0
    depends_on:
      - redis
    volumes:
      - ./app/static:/app/app/static

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    depends_on:
      - web
```

## ğŸš€ å®Ÿè£…é–‹å§‹æº–å‚™

### 8.1 å³åº§ã«å®Ÿè¡Œã™ã¹ãæº–å‚™ä½œæ¥­

```bash
# 1. APIã‚­ãƒ¼å–å¾—
echo "1. Google AI Studioã§Gemini APIã‚­ãƒ¼å–å¾—"
echo "2. Black Forest Labsã§BFL APIã‚­ãƒ¼å–å¾—"

# 2. é–‹ç™ºç’°å¢ƒæ§‹ç¯‰
python3.12 -m venv .venv
source .venv/bin/activate
pip install --upgrade pip

# 3. å¿…è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æº–å‚™
cat > requirements.txt << 'EOF'
Flask==3.0.3
Flask-SocketIO==5.3.6
Celery==5.3.6
Redis==5.0.1
google-genai>=1.0.0
requests==2.31.0
Pillow==10.0.1
python-dotenv==1.0.0
Flask-WTF==1.2.1
Flask-Limiter==3.5.0
pytest==7.4.3
pytest-flask==1.3.0
gunicorn[eventlet]==21.2.0
locust==2.17.0
eventlet==0.35.2
kombu==5.3.5
EOF

# 4. ç’°å¢ƒå¤‰æ•°è¨­å®š
cat > .env.example << 'EOF'
GEMINI_API_KEY=your_gemini_api_key_here
BFL_API_KEY=your_bfl_api_key_here
REDIS_URL=redis://localhost:6379/0
SECRET_KEY=your_secret_key_here
UPLOAD_FOLDER=app/static/uploads
GENERATED_FOLDER=app/static/generated
MAX_CONTENT_LENGTH=10485760
FLASK_ENV=development
EOF
```

## ğŸ“Š ã‚³ã‚¹ãƒˆè©¦ç®—

### 9.1 APIåˆ©ç”¨ã‚³ã‚¹ãƒˆ

```yaml
FLUX.1 Kontext [pro]: $0.06-0.08/ç”»åƒ
Gemini 2.5 Flash: ç„¡æ–™æ å†…ã§ååˆ†

æœˆé–“æƒ³å®šã‚³ã‚¹ãƒˆ:
  - 200ç”»åƒ/æ—¥ Ã— 30æ—¥ = 6,000ç”»åƒ/æœˆ
  - 6,000ç”»åƒ Ã— $0.07 = $420/æœˆ
  - å¹´é–“: $5,040
```

### 9.2 ã‚¤ãƒ³ãƒ•ãƒ©ã‚³ã‚¹ãƒˆ

```yaml
é–‹ç™ºç’°å¢ƒ:
  - Redis: ãƒ­ãƒ¼ã‚«ãƒ«ï¼ˆç„¡æ–™ï¼‰
  - Pythonç’°å¢ƒ: ãƒ­ãƒ¼ã‚«ãƒ«ï¼ˆç„¡æ–™ï¼‰

æœ¬ç•ªç’°å¢ƒï¼ˆæƒ³å®šï¼‰:
  - VPS: $50-100/æœˆ
  - Redis Cloud: $0-30/æœˆ
  - CDN: $20-50/æœˆ
```

## ğŸ”§ APIçµ±åˆã®é‡è¦ãªä»•æ§˜

### 10.1 FLUX.1 Kontext APIåˆ¶é™äº‹é …

```python
# é‡è¦ãªåˆ¶é™äº‹é …ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
API_CONSTRAINTS = {
    "prompt_max_tokens": 512,  # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€å¤§é•·
    "supported_formats": ["JPG", "JPEG", "PNG", "WebP"],
    "input_image_encoding": "base64",
    "signed_url_validity": 600,  # 10åˆ†ï¼ˆç§’ï¼‰
    "polling_interval": 1.5,  # æ¨å¥¨é–“éš”ï¼ˆç§’ï¼‰
    "max_wait_time": 300,  # æ¨å¥¨æœ€å¤§å¾…æ©Ÿï¼ˆç§’ï¼‰
    "rate_limits": "APIã‚­ãƒ¼ä¾å­˜"
}

# ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
ERROR_HANDLING = {
    "Content Moderated": "å…¥åŠ›ç”»åƒãŒåˆ¶é™ã«å¼•ã£ã‹ã‹ã£ãŸ",
    "Request Moderated": "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒåˆ¶é™ã«å¼•ã£ã‹ã‹ã£ãŸ", 
    "Error": "ç”Ÿæˆã‚¨ãƒ©ãƒ¼",
    "Task not found": "ã‚¿ã‚¹ã‚¯IDãŒè¦‹ã¤ã‹ã‚‰ãªã„"
}

# ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–ã®ã‚³ãƒ„
PROMPTING_BEST_PRACTICES = {
    "specificity": "å…·ä½“çš„ã§æ˜ç¢ºãªæŒ‡ç¤º",
    "character_consistency": "maintain identical facial features",
    "preservation": "keep the same lighting and background",
    "text_editing": "Replace 'old text' with 'new text'",
    "style_transfer": "å…·ä½“çš„ãªã‚¹ã‚¿ã‚¤ãƒ«åã‚’ä½¿ç”¨"
}
```

### 10.2 ç¾å®¹å®¤å‘ã‘æœ€é©åŒ–ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```python
# ç¾å®¹å®¤å°‚ç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
HAIRSTYLE_TEMPLATES = {
    "cut_change": "Change the hairstyle to {style_name} while maintaining identical facial features, expression, and skin tone. Keep the same lighting, background, and camera angle.",
    
    "color_change": "Change the hair color to {color_name} while keeping the exact same hairstyle, facial features, and expression. Maintain identical lighting and background.",
    
    "style_and_color": "Transform the hairstyle to {style_name} and change hair color to {color_name} while preserving identical facial features, expression, and composition.",
    
    "length_adjustment": "Adjust the hair length to {length_description} while maintaining the same style, facial features, and overall composition."
}

# ä½¿ç”¨ä¾‹
def create_hairstyle_prompt(change_type, **kwargs):
    template = HAIRSTYLE_TEMPLATES.get(change_type)
    if template:
        return template.format(**kwargs)
    return None
```

### 4.2. ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢

| ã‚«ãƒ†ã‚´ãƒª | ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç›®çš„ |
|---|---|---|---|
| **è¨€èª** | Python | 3.12+ | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºè¨€èª |
| **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯** | Flask | 3.0+ | Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| **éåŒæœŸå‡¦ç†** | Celery | 5.3+ | ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¿ã‚¹ã‚¯å‡¦ç† |
| **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼**| Redis | 5.0+ | Celeryã®ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ |
| **AI (ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ)** | google-genai | 1.0+ | Gemini APIé€£æº |
| **HTTPé€šä¿¡** | requests | 2.31+ | å¤–éƒ¨APIé€£æº |
| **Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°** | beautifulsoup4 | 4.12+ | HTMLãƒ‘ãƒ¼ã‚¹ã€ç”»åƒURLæŠ½å‡º |
| **ç”»åƒå‡¦ç†** | Pillow | 10.0+ | ç”»åƒã®ãƒªã‚µã‚¤ã‚ºã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ› |
| **æœ¬ç•ªã‚µãƒ¼ãƒãƒ¼** | Gunicorn | 21.2+ | WSGIã‚µãƒ¼ãƒãƒ¼ |
| **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡**| Flask-SocketIO | 5.3+ | WebSocketé€šä¿¡ |
| **ãƒ†ã‚¹ãƒˆ** | Pytest, Locust | - | å˜ä½“ãƒ†ã‚¹ãƒˆã€è² è·ãƒ†ã‚¹ãƒˆ |

---

## 5. æ€§èƒ½è¦ä»¶

## ğŸ§‘â€ğŸ’» ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼è¿½åŠ 
- ã€Œé«ªå‹ã ã‘ã‚’å¤‰ãˆãŸã„ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãŸã‚ã€ç”»åƒä¸Šã§é«ªéƒ¨åˆ†ã‚’æ‰‹å‹•ã§ãƒã‚¹ã‚­ãƒ³ã‚°ã§ãã‚‹UIã‚’æä¾›
- ç”Ÿæˆãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ï¼ˆãƒã‚¹ã‚¯ãªã—/ã‚ã‚Šï¼‰ã§ç”¨é€”ã«å¿œã˜ãŸä½¿ã„åˆ†ã‘ãŒå¯èƒ½

## ğŸ¨ UI/UXè¦ä»¶è¿½åŠ 
- ç”»åƒä¸Šã§ãƒ–ãƒ©ã‚·ã«ã‚ˆã‚‹æ‰‹å‹•ãƒã‚¹ã‚­ãƒ³ã‚°ï¼ˆé«ªéƒ¨åˆ†ã®ã¿ç·¨é›†ï¼‰
- ãƒ–ãƒ©ã‚·ã‚µã‚¤ã‚ºèª¿æ•´ã€Undoã€ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½
- ã‚¹ãƒãƒ›ãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã§ã‚‚ç›´æ„Ÿçš„ã«æ“ä½œå¯èƒ½
- ç”Ÿæˆãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿UIï¼ˆKontext/Fillï¼‰
- Toastifyç­‰ã«ã‚ˆã‚‹å³æ™‚é€šçŸ¥UI

## ğŸ› ï¸ éæ©Ÿèƒ½è¦ä»¶è¿½åŠ 
- ObjectURLã®è§£æ”¾æ¨å¥¨ï¼ˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»åƒï¼‰
- ç”»åƒãƒªã‚µã‚¤ã‚ºæ™‚ã¯canvasã‚‚å†èª¿æ•´
- ã‚¨ãƒ©ãƒ¼æ™‚ã¯Toastifyç­‰ã§å³æ™‚é€šçŸ¥

## ğŸ”Œ APIä»•æ§˜è¿½åŠ 
- /generateã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§modeï¼ˆkontext/fillï¼‰ã¨mask_dataï¼ˆBase64 PNGï¼‰ã‚’å—ã‘ä»˜ã‘ã€é«ªã ã‘ç·¨é›†ã™ã‚‹å ´åˆã¯Fill APIã‚’å‘¼ã³å‡ºã™

## ğŸ§ª ãƒ†ã‚¹ãƒˆè¦ä»¶è¿½åŠ 
- ãƒã‚¹ã‚­ãƒ³ã‚°UIã®å‹•ä½œãƒ†ã‚¹ãƒˆï¼ˆæç”»ãƒ»Undoãƒ»ãƒªã‚»ãƒƒãƒˆãƒ»ã‚¹ãƒãƒ›å¯¾å¿œï¼‰
- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»URLå–å¾—ã©ã¡ã‚‰ã§ã‚‚ãƒã‚¹ã‚­ãƒ³ã‚°ã§ãã‚‹ã“ã¨
- ç”Ÿæˆãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿æ™‚ã®æŒ™å‹•ãƒ†ã‚¹ãƒˆ
