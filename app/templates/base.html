<!DOCTYPE html>
<html lang="ja" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Hair Style AI Generator{% endblock %}</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        'slate': {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            800: '#1e293b',
                            900: '#0f172a',
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600&display=swap" rel="stylesheet">
    
    <!-- Socket.IO -->
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.14.0/dist/cdn.min.js"></script>

    <!-- Axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.2/dist/axios.min.js"></script>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üíá</text></svg>">
    
    <style>
        /* „Ç´„Çπ„Çø„É†„Çπ„Çø„Ç§„É´ */
        body {
            font-family: 'Inter', system-ui, sans-serif;
        }
        
        /* „Çπ„É†„Éº„Ç∫„Çπ„ÇØ„É≠„Éº„É´ */
        html {
            scroll-behavior: smooth;
        }
        
        /* „Éï„Ç©„Éº„Ç´„Çπ„Çπ„Çø„Ç§„É´ */
        .focus\\:ring-2:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(15, 23, 42, 0.1);
        }
        
        /* „Ç´„Çπ„Çø„É†„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out;
        }
        
        /* „Éà„É©„É≥„Ç∏„Ç∑„Éß„É≥ */
        * {
            transition-duration: 0.2s;
            transition-timing-function: ease-out;
        }
        
        /* „Éâ„É≠„ÉÉ„Éó„Ç∑„É£„Éâ„Ç¶ */
        .shadow-custom {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.03), 0 1px 2px 0 rgba(0, 0, 0, 0.02);
        }
    </style>
</head>

<body class="h-full bg-slate-50 text-slate-900">
    <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„Éä -->
    <div class="min-h-full">
        <!-- „Éò„ÉÉ„ÉÄ„ÉºÔºà„Ç∑„É≥„Éó„É´Ôºâ -->
        <header class="bg-white border-b border-slate-100">
            <div class="max-w-6xl mx-auto px-6 py-6">
                <div class="flex items-center justify-between">
                    <a href="{{ url_for('main.index') }}" class="text-xl font-medium text-slate-900 hover:text-slate-700 transition-colors">
                        Hair Style AI
                    </a>
                    
                    <!-- „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ÔºàÊúÄÂ∞èÈôêÔºâ -->
                    {% if session.user_id %}
                    <div class="flex items-center space-x-6">
                        <span class="text-sm text-slate-500">{{ session.user_name }}</span>
                        <a href="{{ url_for('main.gallery') }}" class="text-sm text-slate-600 hover:text-slate-900 transition-colors">„ÇÆ„É£„É©„É™„Éº</a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </header>
        
        <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
        <main class="py-12 px-6">
            {% block content %}{% endblock %}
        </main>
        
        <!-- „Éï„ÉÉ„Çø„ÉºÔºàÊúÄÂ∞èÈôêÔºâ -->
        <footer class="border-t border-slate-100 bg-white">
            <div class="max-w-6xl mx-auto px-6 py-8">
                <div class="text-center">
                    <p class="text-sm text-slate-400">
                        &copy; 2025 Hair Style AI Generator. Powered by FLUX.1 Kontext & Gemini AI.
                    </p>
                </div>
            </div>
        </footer>
    </div>
    
    <!-- ÈÄöÁü•„Ç®„É™„Ç¢ -->
    <div id="notifications" class="fixed top-4 right-4 z-50 space-y-2"></div>
    
    <!-- Ë®≠ÂÆö„Éá„Éº„Çø -->
    <div id="app-config" 
         data-max-file-size="{{ config.MAX_CONTENT_LENGTH or 10485760 }}"
         data-max-file-size-mb="{{ (config.MAX_CONTENT_LENGTH / 1024 / 1024)|round(1) if config.MAX_CONTENT_LENGTH else 10 }}"
         style="display: none;"></div>
    
    <!-- ÂÖ±ÈÄöJavaScript -->
    <script>
        // Socket.IOÊé•Á∂ö
        const socket = io();
        
        // Ë®≠ÂÆö„Éá„Éº„Çø„ÇíË™≠„ÅøÂèñ„Çä
        const configElement = document.getElementById('app-config');
        window.HairStyleApp = {
            config: {
                maxFileSize: parseInt(configElement.dataset.maxFileSize),
                maxFileSizeMB: parseFloat(configElement.dataset.maxFileSizeMb),
                supportedFormats: ['image/jpeg', 'image/jpg', 'image/png', 'image/webp']
            }
        };
        
        // ÈÄöÁü•Ë°®Á§∫Ê©üËÉΩ
        function showNotification(type, message) {
            const notifications = document.getElementById('notifications');
            const notification = document.createElement('div');
            
            const colors = {
                'success': 'bg-green-50 border-green-200 text-green-800',
                'error': 'bg-red-50 border-red-200 text-red-800',
                'info': 'bg-blue-50 border-blue-200 text-blue-800',
                'warning': 'bg-yellow-50 border-yellow-200 text-yellow-800'
            };
            
            notification.className = `${colors[type]} border rounded-xl px-4 py-3 shadow-sm animate-fadeIn min-w-80`;
            notification.innerHTML = `
                <div class="flex items-center justify-between">
                    <p class="text-sm font-medium">${message}</p>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-3 text-current opacity-50 hover:opacity-100">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            notifications.appendChild(notification);
            
            // 5ÁßíÂæå„Å´Ëá™ÂãïÂâäÈô§
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }
        
        // showAlertÈñ¢Êï∞ÔºàÊó¢Â≠ò„Ç≥„Éº„Éâ„Å®„ÅÆ‰∫íÊèõÊÄßÔºâ
        window.showAlert = showNotification;
        
        // Socket.IOÊé•Á∂öÁ¢∫Ë™ç
        socket.on('connect', function() {
            console.log('Socket.IO connected');
        });
        
        socket.on('disconnect', function() {
            console.log('Socket.IO disconnected');
        });
        
        // „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞
        window.addEventListener('error', function(e) {
            console.error('Global error:', e.error);
        });
        
        // Axios„ÅÆ„Éá„Éï„Ç©„É´„ÉàË®≠ÂÆö
        axios.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';
        
        // „É¨„Çπ„Éù„É≥„Ç∑„Éñ„Éá„Ç∂„Ç§„É≥Á¢∫Ë™ç
        function checkMobile() {
            return window.innerWidth < 768;
        }
        
        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÂÆå‰∫ÜÊôÇ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Hair Style AI Generator loaded');
        });
    </script>
    
    {% block scripts %}{% endblock %}
</body>
</html> 